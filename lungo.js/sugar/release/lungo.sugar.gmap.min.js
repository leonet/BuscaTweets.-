LUNGO.Sugar.GMap=function(j){var e=null,g=[];return{init:function(a){var b=j.dom(a.el);if(b.length>0)e=this.Interface.Map(b[0],a);else console.error("Imposible")},instance:function(){return e},clean:function(){for(var a=0,b=g.length;a<b;a++)g[a].setMap(null);g=[];this.Route.clean()},center:function(a){e.setCenter(this.Interface.LatLng(a))},zoom:function(a){e.setZoom(a)},addMarker:function(a,b,h){if(a){var i=new google.maps.Marker({map:e,icon:this.Interface.MarkerIcon(b),animation:google.maps.Animation.DROP,
position:this.Interface.LatLng(a)});h&&i.setAnimation(google.maps.Animation.BOUNCE);g.push(i)}return i}}}(LUNGO);LUNGO.Sugar.GMap.Interface=function(j){var e={ROADMAP:"roadmap",SATELLITE:"satellite",HYBRID:"hybrid",TERRAIN:"terrain"},g={zoom:12,disableDefaultUI:true,mapTypeId:e.ROADMAP};return{Map:function(a,b){if(b.type)b.mapTypeId=e[b.type];if(b.center)b.center=new google.maps.LatLng(b.center.latitude,b.center.longitude);return new google.maps.Map(a,j.Core.mix(g,b))},LatLng:function(a){return new google.maps.LatLng(a.latitude,a.longitude)},MarkerIcon:function(a){if(a)var b=new google.maps.MarkerImage(a.url,
new google.maps.Size(a.size.x,a.size.y),new google.maps.Point(0,0),new google.maps.Point(a.anchor.x,a.anchor.y));return b||null}}}(LUNGO);LUNGO.Sugar.GMap.Route=function(j,e){var g={WALKING:"WALKING",DRIVING:"DRIVING",BICYCLING:"BICYCLING"},a={service:null,directions:null,route:null,instructions:null,markers:{icons:[],pointers:[]}},b=LUNGO.Sugar.GMap,h=null,i=function(){if(a.renderer){a.renderer.setMap(null);for(var c=0,d=a.markers.pointers.length;c<d;c++)a.markers.pointers[c].setMap(null);a.markers.pointers=[]}},m=function(c,d,f){a.markers.icons=f;a.markers.from=c;a.markers.to=d},k=function(c,d){var f=b.addMarker(c,d||null);a.markers.pointers.push(f)};
return{init:function(c,d,f,n,o){h=o||null;m(c,d,n);a.route=null;a.instructions=null;a.service=a.service||new google.maps.DirectionsService;a.service.route({origin:b.Interface.LatLng(c),destination:b.Interface.LatLng(d),travelMode:f!==e?g[f]:g.DRIVING},function(l,p){if(p==google.maps.DirectionsStatus.OK){a.route=l;a.instructions=l.routes[0].legs[0];i();a.renderer=new google.maps.DirectionsRenderer({suppressMarkers:a.markers.icons?true:false});a.renderer.setMap(b.instance());a.renderer.setDirections(a.route);
if(a.markers.icons){k(a.markers.from,a.markers.icons.from);k(a.markers.to,a.markers.icons.to)}h&&h.apply(h)}})},clean:i,instructions:function(){var c={};if(a.instructions){c.distance=a.instructions.distance.text;c.duration=a.instructions.duration.text;var d=[];for(index in a.instructions.steps){var f=a.instructions.steps[index];d.push({distance:f.distance.text,duration:f.duration.text,instructions:f.instructions})}c.steps=d}return c}}}(LUNGO);
